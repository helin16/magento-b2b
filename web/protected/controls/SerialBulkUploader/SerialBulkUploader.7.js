var SerialBulkUploaderJs=new Class.create;
SerialBulkUploaderJs.prototype=Object.extend(new BPCPageJs,{_pageJs:null,initialize:function(d,a){this._pageJs=d;this.product=a},getInputPanel:function(){var d,a,c,b,e,g,f;d=this;a=[];return(new Element("div",{"class":"bulkSerialPanel"})).store("data",null).insert({bottom:(new Element("div",{"class":"row"})).insert({bottom:(new Element("div",{"class":"col-sm-4"})).insert({bottom:(new Element("div",{"class":"form-group form-group-sm input-group"})).insert({bottom:(new Element("div",{"class":"input-group-addon"})).update("Unit Price")}).insert({bottom:new Element("input",
{"class":"serial-info form-control input-sm","serial-info":"unitPrice",type:"number",required:"Required!",placeholder:"Unit Price",title:"Unit Price"})})})}).insert({bottom:(new Element("div",{"class":"col-sm-4"})).insert({bottom:(new Element("div",{"class":"form-group form-group-sm input-group"})).insert({bottom:(new Element("div",{"class":"input-group-addon"})).update("Inv. No.")}).insert({bottom:new Element("input",{"class":"serial-info form-control input-sm","serial-info":"invoiceNo",type:"text",
required:"Required!",placeholder:"Invoice Number",title:"Invoice Number"})})})}).insert({bottom:(new Element("div",{"class":"col-sm-4"})).insert({bottom:(new Element("div",{"class":"form-group form-group-sm input-group"})).insert({bottom:(new Element("div",{"class":"input-group-addon"})).update("Comments")}).insert({bottom:new Element("input",{"class":"serial-info form-control input-sm","serial-info":"comments",type:"text",placeholder:"Comments",title:"Comments"})})})})}).insert({bottom:(new Element("div",
{"class":"row"})).insert({bottom:(new Element("div",{"class":"col-sm-12"})).insert({bottom:(new Element("span")).update("<b>Serial Numbers</b>")}).insert({bottom:(new Element("span",{"class":"pull-right serials-bulk-qty"})).setStyle("font-weight: bold;").update("Qty: "+a.length)})}).insert({bottom:(new Element("div",{"class":"col-sm-12"})).insert({bottom:(new Element("textarea",{"class":"form-control",rows:20,name:"serials",type:"textarea",placeholder:"Serial Numbers",title:"Serial Numbers"})).observe("change",
function(b){c=$(this);a=d._expressionMatch($F(c));c.up(".bulkSerialPanel").store("serials",a);c.value=a.join("\n");c.up(".bulkSerialPanel").getElementsBySelector(".serials-bulk-qty").each(function(b){b.update("Qty: "+a.length)})})})}).insert({bottom:(new Element("div",{"class":"col-sm-12"})).insert({bottom:(new Element("span",{"class":"pull-right serials-bulk-qty"})).setStyle("font-weight: bold;").update("Qty: "+a.length)})})}).insert({bottom:(new Element("div",{"class":"row"})).insert({bottom:(new Element("div",
{"class":"col-sm-12"})).insert({bottom:(new Element("span",{"class":"btn btn-md btn-success pull-right confimBtn"})).update("Confirm").observe("click",function(c){b=$(this);b.clicked=!0;d._signRandID(b);jQuery("#"+b.id).button("loading");!0===b.clicked&&(b.clicked=!1,e=[],g=$(this),a=$(this).up(".bulkSerialPanel").retrieve("serials",a),a.each(function(a){f=d._collectFormData(g.up(".bulkSerialPanel"),"serial-info");null!==f&&(f.qty=1,f.serialNo=a,""===f.comments&&(f.comments="BULK IMPORTED"),e.push(f),
e.product=d.product)}),null!==d._collectFormData(g.up(".bulkSerialPanel"),"serial-info")&&$(this).up(".bulkSerialPanel").store("data",e));jQuery("#"+b.id).button("reset")})})})})},_expressionMatch:function(d,a){var c,b,e;b=a||!0;c=d.replace(/(\s*),(\s*)/g,"\n").replace(/(\s*);(\s*)/g,"\n");!0===b&&(c=c.replace(/(\s*)\s(\s*)/g,"\n"));e=[];c.split("\n").each(function(a){a.blank()||e.push(a.strip())});return e}});