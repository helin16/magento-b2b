var PageJs=new Class.create;PageJs.prototype=Object.extend(new DetailsPageJs,{_item:{},setPreData:function(e){return this._item=e,this},_submitSave:function(e){var t={};return t.me=this,t.data=t.me._collectFormData($(t.me._htmlIds.itemDiv),"save-item"),t.data.id=t.me._customer.id?t.me._customer.id:"",null===t.data?t.me:(t.me.saveItem(e,t.data,function(e){t.me.showModalBox('<strong class="text-success">Saved Successfully!</strong>',"Saved Successfully!",!0),t.me._item=e.item,t.me.refreshParentWindow(),window.parent.jQuery.fancybox.close()}),t.me)},_getAddressDiv:function(e,t){var n={};return n.me=this,n.addr=e||{},new Element("div",{"class":"address-div panel panel-default","address-editable":!0}).insert({bottom:new Element("div",{"class":"panel-heading"}).update(t)}).insert({bottom:new Element("div",{"class":"panel-body"}).insert({bottom:new Element("dl",{"class":"dl-horizontal dl-condensed"}).insert({bottom:new Element("dt").update(new Element("span",{"class":"glyphicon glyphicon-user",title:" Name"}))}).insert({bottom:new Element("dd").insert({bottom:new Element("div").insert({bottom:new Element("div",{"class":"col-sm-6"}).update(new Element("input",{"address-editable-field":"contactName","class":"form-control input-sm",placeholder:"The name of contact person",value:n.addr.contactName?n.addr.contactName:""}))}).insert({bottom:new Element("div",{"class":"col-sm-6"}).update(new Element("input",{"address-editable-field":"contactNo","class":"form-control input-sm",placeholder:"The contact number of contact person",value:n.addr.contactNo?n.addr.contactNo:""}))})})}).insert({bottom:new Element("dt").update(new Element("span",{"class":"glyphicon glyphicon-map-marker",title:"Address"}))}).insert({bottom:new Element("dd").insert({bottom:new Element("div").insert({bottom:new Element("div",{"class":"street col-sm-12"}).update(new Element("input",{"address-editable-field":"street","class":"form-control input-sm",placeholder:"Street Number and Street name",value:n.addr.street?n.addr.street:""}))})}).insert({bottom:new Element("div").insert({bottom:new Element("div",{"class":"city col-sm-6"}).update(new Element("input",{"address-editable-field":"city","class":"form-control input-sm",placeholder:"City / Suburb",value:n.addr.city?n.addr.city:""}))}).insert({bottom:new Element("div",{"class":"region col-sm-3"}).update(new Element("input",{"address-editable-field":"region","class":"form-control input-sm",placeholder:"State / Province",value:n.addr.region?n.addr.region:""}))}).insert({bottom:new Element("div",{"class":"postcode col-sm-3"}).update(new Element("input",{"address-editable-field":"postCode","class":"form-control input-sm",placeholder:"PostCode",value:n.addr.postCode?n.addr.postCode:""}))})}).insert({bottom:new Element("div").insert({bottom:new Element("div",{"class":"postcode col-sm-4"}).update(new Element("input",{"address-editable-field":"country","class":"form-control input-sm",placeholder:"Country",value:n.addr.country?n.addr.country:""}))})})})})})},_getItemDiv:function(){var e={};return e.me=this,e.newDiv=new Element("div",{"class":"item-editing-container"}).insert({bottom:new Element("div",{"class":"row"}).insert({bottom:e.me._getFormGroup("Name:",new Element("input",{"edit-field":"name",name:"name",value:e.me._item.name})).wrap(new Element("div",{"class":"col-sm-4"}))}).insert({bottom:e.me._getFormGroup("Description:",new Element("input",{"edit-field":"description",value:e.me._item.description})).wrap(new Element("div",{"class":"col-sm-8"}))})}).insert({bottom:new Element("div",{"class":"row"}).insert({bottom:e.me._getFormGroup("Contact Name:",new Element("input",{"edit-field":"contactName",value:e.me._item.contactName})).wrap(new Element("div",{"class":"col-sm-4"}))}).insert({bottom:e.me._getFormGroup("contact Number:",new Element("input",{"edit-field":"contactNo",value:e.me._item.contactNo})).wrap(new Element("div",{"class":"col-sm-4"}))}).insert({bottom:e.me._getFormGroup("Email:",new Element("input",{"edit-field":"email",name:"email",value:e.me._item.email})).wrap(new Element("div",{"class":"col-sm-4"}))})}).insert({bottom:new Element("div",{"class":"row"}).insert({bottom:e.me._getAddressDiv(e.me._item.address,"Address").wrap(new Element("div",{"class":"col-sm-12"}))})}).insert({bottom:new Element("div",{"class":"row"}).insert({bottom:new Element("div",{"class":"form-group"}).insert({bottom:new Element("input",{"edit-field":"id",type:"hidden",value:e.me._item.id?e.me._item.id:""})}).insert({bottom:new Element("button",{id:"save-btn",type:"submit","class":"btn btn-primary pull-right col-sm-3","data-loading-text":"saving ..."}).update("SAVE")})})}),e.newDiv},refreshParentWindow:function(e){var t={};t.me=this,window.parent&&(t.parentWindow=window.parent,t.resultDiv=$(t.parentWindow.document.body).down("#"+t.parentWindow.pageJs.resultDivId),t.parentResultTbody=t.resultDiv?t.resultDiv.down("tbody"):void 0,t.parentResultTbody&&(t.row=t.parentResultTbody.down(".item_row[item_id="+e.id+"]"),t.row?t.row.replace(t.parentWindow.pageJs._getResultRow(e)):t.parentResultTbody.insert({top:t.parentWindow.pageJs._getResultRow(e)})))},_getFormGroup:function(e,t){return new Element("div",{"class":"form-group form-group-sm form-group-sm-label"}).insert({bottom:new Element("label",{"class":"control-label"}).update(e)}).insert({bottom:t.addClassName("form-control")})},_init:function(){var e={};return e.me=this,jQuery(window).ready(function(){e.mainForm=jQuery("#"+e.me.getHTMLID("main-form")),e.mainForm.formValidation({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{name:{validators:{notEmpty:{message:"The name of the supplier is needed."}}},email:{validators:{emailAddress:{message:"please provide a valid email address"}}}}}).on("err.form.fv",function(){e.mainForm.data("formValidation").getSubmitButton()&&e.mainForm.data("formValidation").disableSubmitButtons(!1)}).on("success.form.fv",function(t){t.preventDefault(),e.mainForm.data("formValidation").getSubmitButton()&&e.mainForm.data("formValidation").disableSubmitButtons(!1),e.data={},$(e.me._htmlIds.itemDiv).getElementsBySelector("[edit-field]").each(function(t){e.data[t.readAttribute("edit-field")]=$F(t)}),e.data.address={},$(e.me._htmlIds.itemDiv).getElementsBySelector("[address-editable-field]").each(function(t){e.data.address[t.readAttribute("address-editable-field")]=$F(t)}),e.me.saveItem($("save-btn"),e.data,function(t){e.me.showModalBox('<strong class="text-success">Success</strong>',"Saved Successfully"),e.me._item=t.item,e.me.refreshParentWindow(t.item),window.location=t.url,window.parent.jQuery.fancybox.close()})})}),e.me}});